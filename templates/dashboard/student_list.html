<!DOCTYPE html>
<html lang="{{ get_locale() }}">
<head>
    <meta charset="UTF-8">
    <title>{{ _("Student List") }}</title>

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
    body { font-family:"Poppins",sans-serif;background:#f7f7fb;margin:0;padding:0;}

    /* üåê Language Switch */
    .lang-switch{
        position:fixed;
        top:14px;
        right:18px;
        font-size:15px;
        font-weight:600;
        z-index:999;
    }
    .lang-switch a{
        text-decoration:none;
        margin:0 4px;
        color:white;
    }
    .lang-switch a:hover{ text-decoration:underline; }

    /* NAVBAR */
    .navbar{
        background:#1B263B;
        padding:14px 22px;
        color:white;
        display:flex;
        align-items:center;
    }
    .navbar span{ font-size:20px;font-weight:600; }
    .navbar a{
        margin-left:auto;
        color:white;
        text-decoration:none;
        background:#d9534f;
        padding:6px 14px;
        border-radius:6px;
        font-size:15px;
    }

    .container{
        width:90%;
        margin:40px auto;
        background:white;
        padding:25px;
        border-radius:15px;
        box-shadow:0 6px 20px rgba(0,0,0,0.06);
    }
    h2{ margin-bottom:15px;font-weight:600;}

    .filter-box{ display:flex;gap:12px;margin-bottom:15px;}

    input, select{
        width:100%;padding:10px;border-radius:8px;
        border:2px solid #ddd;font-size:15px;transition:.3s;
    }
    input:focus,select:focus{border-color:#f4c430;outline:none;}

    .btn{
        padding:10px 20px;border:none;font-size:15px;
        cursor:pointer;border-radius:8px;transition:.3s;
    }
    .btn-primary{background:#1B263B;color:white;}
    .btn-primary:hover{background:#31415c;}

    table{width:100%;border-collapse:collapse;border-radius:12px;overflow:hidden;}
    th{
        background:#f4c430;padding:14px;text-align:left;
        font-size:16px;position:sticky;top:0;
    }
    td{padding:12px;border-bottom:1px solid #eee;}
    tr:hover{background:#fff9d8;}

    .action-btn{padding:6px 10px;border-radius:6px;color:white;text-decoration:none;}
    .edit{background:#2ea44f;}
    .delete{background:#d9534f;}

    .export-box{margin-top:15px;}
    .export-box .btn{margin-right:10px;}

    .pagination{display:flex;gap:6px;list-style:none;margin-top:15px;}
    .pagination a{
        text-decoration:none;padding:6px 12px;background:white;
        border:1px solid #ddd;border-radius:5px;transition:.3s;
    }
    .pagination .active a{background:#f4c430;color:white;border:none;}
    .pagination a:hover{background:#f4c430;color:white;}
</style>
</head>

<body>

<!-- NAVBAR -->
<div class="navbar">
    <span>üë• {{ _("Student Management") }}</span>

    <a href="/teacher/dashboard">‚¨Ö {{ _("Dashboard") }}</a>
    <a href="/logout" style="margin-left:12px;background:#b90e0e;">{{ _("Logout") }}</a>
</div>

<!-- üåê Language Top-Right -->
<div class="lang-switch">
    <a href="{{ url_for('set_language','en') }}">EN</a> |
    <a href="{{ url_for('set_language','hi') }}">HI</a> |
    <a href="{{ url_for('set_language','gu') }}">GU</a>
</div>


<div class="container">

    <h2>{{ _("Student Directory") }}</h2>

    <!-- FILTERS -->
    <form method="GET" action="/teacher/students">
        <div class="filter-box">

            <input type="text" name="search" value="{{ search_query }}"
                   placeholder="üîç {{ _('Search name, village, or enrollment...') }}">

            <select name="class_filter">
                <option value="all">üìö {{ _('All Classes') }}</option>
                {% for c in classes %}
                    <option value="{{ c }}" {% if selected_class == c %}selected{% endif %}>{{ c }}</option>
                {% endfor %}
            </select>

            <button class="btn btn-primary">{{ _("Filter") }}</button>
        </div>
    </form>

    <!-- TABLE -->
    <table>
        <thead>
            <tr>
                <th>{{ _("Enrollment") }}</th>
                <th>{{ _("Name") }}</th>
                <th>{{ _("Class") }}</th>
                <th>{{ _("Phone") }}</th>
                <th>{{ _("Village") }}</th>
                <th>{{ _("Date Joined") }}</th>
                <th>{{ _("Actions") }}</th>
            </tr>
        </thead>

        <tbody>
        {% for student in students.items %}
        <tr>
            <td>{{ student.enrollment_no }}</td>
            <td>{{ student.name }}</td>
            <td>{{ student.class_name }}</td>
            <td>{{ student.student_phone }}</td>
            <td>{{ student.village }}</td>
            <td>{{ student.date_joined.strftime('%d %b %Y') if student.date_joined else '‚Äî' }}</td>

            <td>
                <a href="/teacher/edit_student/{{ student.id }}" class="action-btn edit">
                    <i class="fa fa-pen"></i>
                </a>
                <a href="/teacher/delete_student/{{ student.id }}" class="action-btn delete"
                   onclick="return confirm('{{ _("Are you sure you want to delete this student?") }}')">
                    <i class="fa fa-trash"></i>
                </a>
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>

<br>

<!-- EXPORT -->
<div class="export-box">
    <a href="/teacher/students/export/csv" class="btn" style="background:#198754;color:white;">
        üìÑ {{ _("Export CSV") }}
    </a>
    <a href="/teacher/students/export/excel" class="btn" style="background:#0d6efd;color:white;">
        üìò {{ _("Export Excel") }}
    </a>
</div>

<!-- PAGINATION -->
<div style="display:flex; justify-content:center; margin-top:18px;">
    <ul class="pagination">

        {% if students.has_prev %}
            <li><a href="{{ url_for('student_list', page=students.prev_num, search=search_query, class_filter=selected_class) }}">‚Üê {{ _("Prev") }}</a></li>
        {% endif %}

        {% for page_num in students.iter_pages() %}
            {% if page_num %}
                <li class="{% if students.page == page_num %}active{% endif %}">
                    <a href="{{ url_for('student_list', page=page_num, search=search_query, class_filter=selected_class) }}">{{ page_num }}</a>
                </li>
            {% endif %}
        {% endfor %}

        {% if students.has_next %}
            <li><a href="{{ url_for('student_list', page=students.next_num, search=search_query, class_filter=selected_class) }}">{{ _("Next") }} ‚Üí</a></li>
        {% endif %}

    </ul>
</div>

</body>
</html>
